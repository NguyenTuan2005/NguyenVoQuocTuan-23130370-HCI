//-----------hightlight navigation bar----------------------
// Get current page URL
const currentPage = window.location.pathname.split('/').pop();

// Add active class to main navigation
if (currentPage.includes('lab')) {
    document.querySelector('.menu a[href="labs.html"]').classList.add('active');
} else {
    document.querySelector(`.menu a[href="${currentPage}"]`)?.classList.add('active');
}

// Add active class to lab menu
if (currentPage === 'labs.html') {
    // When on labs.html, highlight Lab 1 since it's shown by default
    document.querySelector('.lab-menu a[href="lab1.html"]').classList.add('active');
} else if (currentPage.includes('lab')) {
    // For other lab pages, highlight the corresponding lab link
    document.querySelector(`.lab-menu a[href="${currentPage}"]`)?.classList.add('active');
}
//-----------hightlight navigation bar----------------------
document.addEventListener('DOMContentLoaded', function () {
    /* -------------------------lab1_group2---------------- */
    const courseForm = document.getElementById('courseForm');
    const courseId = document.getElementById('courseId');
    const createdAt = document.getElementById('createdAt');
    const updatedAt = document.getElementById('updatedAt');
    // Simulating dynamic ID and timestamp generation for demonstration
    function generateCourseId() {
        return 'COURSE-' + Math.floor(Math.random() * 10000);
    }

    function getCurrentTimestamp() {
        const now = new Date();
        return now.toISOString().slice(0, 19).replace('T', ' ');
    }

    // Populate auto-generated fields when the form is loaded
    function populateAutoGeneratedFields() {
        if (!courseId.value) {
            courseId.value = generateCourseId();  // Generate and display course ID
        }
        if (!createdAt.value) {
            createdAt.value = getCurrentTimestamp();  // Set creation timestamp
        }
        updatedAt.value = getCurrentTimestamp();  // Set the last updated timestamp
    }

    // Form submission handler
    courseForm.addEventListener('submit', function (event) {
        event.preventDefault();

        // Basic validation (course name required)
        const courseName = document.getElementById('courseName').value;
        if (!courseName) {
            alert('Course name is required');
            return;
        }

        // Update the "Last Updated" timestamp
        updatedAt.value = getCurrentTimestamp();

        alert('Course Created/Updated Successfully!');
    });

    // Pre-populate the form with auto-generated fields on load
    populateAutoGeneratedFields();
    /* -------------------------lab1_group2---------------- */
});
/* -------------------------lab1_group1---------------- */
const form = document.getElementById('accountForm');
const submitButton = document.getElementById('submitButton');
const accCreatedAt = document.getElementById('accCreatedAt');
const lastUpdatedAt = document.getElementById('lastUpdatedAt');
const profilePictureInput = document.getElementById('profilePictureInput');
const profilePreview = document.getElementById('profilePreview');
const cancelButton = document.getElementById('cancelButton');

function togglePassword() {
    var x = document.getElementById("password");
    if (x.type === "password") {
        x.type = "text";
    } else {
        x.type = "password";
    }
}

// Profile picture preview
profilePictureInput.addEventListener('change', function (e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function (event) {
            profilePreview.src = event.target.result;
            profilePreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
    } else {
        profilePreview.style.display = 'none';
    }
});

// Set initial timestamps
const now = new Date().toLocaleString();
accCreatedAt.value = now;
lastUpdatedAt.value = now;

// Function to check if all required fields are valid
function checkFormValidity() {
    const isValid = form.checkValidity();
    submitButton.disabled = !isValid;
}

// Inline error validation messages
form.querySelectorAll('input, select').forEach(input => {
    input.addEventListener('input', function () {
        const errorMessage = input.nextElementSibling;
        if (!input.checkValidity()) {
            errorMessage.textContent = input.validationMessage;
        } else {
            errorMessage.textContent = '';
        }
    });
});

// Cancel button to go back to the previous page
cancelButton.addEventListener('click', function () {
    window.history.back();  // Navigate back to the previous page
});

// Form submission handler
form.addEventListener('submit', function (e) {
    e.preventDefault();
    if (form.checkValidity()) {
        lastUpdatedAt.value = new Date().toLocaleString();
        console.log('Form submitted successfully');
    }
});

// Initial check (in case some fields are pre-filled)
checkFormValidity();
/* -------------------------lab1_group1---------------- */

// Toggling Group Content
function toggleGroup(groupId) {
    var group = document.getElementById(groupId);

    if (group.classList.contains("show")) {
        // When hiding
        group.style.maxHeight = group.scrollHeight + "px"; // Set height to content height
        group.style.opacity = "1"; // Ensure it's visible before collapsing

        // Trigger the collapse
        setTimeout(function() {
            group.style.maxHeight = "0px"; // Collapse height
            group.style.opacity = "0"; // Fade out
        }, 10);

        // Remove the 'show' class after the transition
        setTimeout(function() {
            group.classList.remove("show");
            group.style.display = "none"; // Optional: remove from layout after hiding
        }, 300); // Match transition duration
    } else {
        // When showing
        group.style.display = "block"; // Make the element visible
        group.style.maxHeight = "0px"; // Start collapsed
        group.style.opacity = "0"; // Start invisible
        
        // Trigger expansion
        setTimeout(function() {
            group.style.maxHeight = group.scrollHeight + "px"; // Expand to fit content
            group.style.opacity = "1"; // Fade in
        }, 10);

        // Add the 'show' class after transition
        setTimeout(function() {
            group.classList.add("show");
        }, 300); // Match transition duration
    }
}

/* -------------------------lab2_group1---------------- */
// function togglePassword() {
//     const passwordInput = document.getElementById('password');
//     const toggleIcon = document.querySelector('.password-toggle');
    
//     if (passwordInput.type === 'password') {
//         passwordInput.type = 'text';
//         toggleIcon.classList.remove('fa-eye');
//         toggleIcon.classList.add('fa-eye-slash');
//     } else {
//         passwordInput.type = 'password';
//         toggleIcon.classList.remove('fa-eye-slash');
//         toggleIcon.classList.add('fa-eye');
//     }
// }
/* -------------------------lab2_group1---------------- */